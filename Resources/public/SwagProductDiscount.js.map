{"version":3,"sources":["webpack:////var/www/shopware/custom/plugins/SwagProductDiscount/Resources/views/src/manifest.js","webpack:////var/www/shopware/custom/plugins/SwagProductDiscount/Resources/views/administration/product-detail.html","webpack:////var/www/shopware/custom/plugins/SwagProductDiscount/Resources/views/src/swag_product_discount.service.js"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,aAAa;AACb,SAAS;;AAET;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA,CAAC,E;;;;;;;AC7ED,mBAAmB,mDAAmD,+JAA+J,aAAa,E;;;;;;;;;ACAlP;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,2CAA2C,aAAa,SAAS,YAAY;AAC7E;AACA;AACA,SAAS;AACT;AACA;AACA,2CAA2C,aAAa;AACxD;AACA;AACA,SAAS;AACT;AACA","file":"static/js/SwagProductDiscount.js","sourcesContent":["import template from '../administration/product-detail.html';\nimport SwagProductDiscountService from './swag_product_discount.service';\n\nShopware.ComponentFactory.override('core-product-detail', {\n    inject: [\n        'httpClient'\n    ],\n\n    data() {\n       return {\n           product: {\n               attributes: {\n                   discount: {}\n               }\n           },\n           discount: {\n               uuid: null,\n               discountPercentage: null,\n               productDetailUuid: null\n           }\n       };\n    },\n\n    mounted() {\n        this.$on('core-product-detail:load:after', this.productLoadAfter.bind(this));\n\n        this.$on('core-product-detail:save:before', this.productSaveAfter.bind(this));\n\n        this.discountService = SwagProductDiscountService(this.httpClient);\n    },\n\n    computed: {\n        productDiscount: {\n            get: function() {\n                if(this.discount && this.discount.discountPercentage) {\n                    return this.discount.discountPercentage;\n                }\n                return null;\n            },\n            set: function(newValue) {\n                if(this.discount && this.discount.uuid) {\n                    this.discount.discountPercentage = newValue;\n                } else {\n                    this.discount = {\n                        productDetailUuid: this.product.mainDetailUuid,\n                        discountPercentage: newValue\n                    }\n                }\n            }\n        }\n    },\n\n    methods: {\n        productLoadAfter(product) {\n            console.log('PRODCUT LOAD AFTER!!!');\n            this.getProductDiscountData(product.mainDetailUuid);\n        },\n\n        productSaveAfter(component)  {\n            // console.log(this.discount);\n            this.updateDiscount(this.discount)\n        },\n\n        getProductDiscountData(productDetailUuid) {\n            this.discountService.readByProductDetailUuid(productDetailUuid).then((response) => {\n                this.discount = response.data[0];\n            });\n        },\n\n        updateDiscount(discount) {\n            this.discountService.update([discount]).then((response) => {\n                console.log('Discount persisted', response.data);\n            });\n        }\n    },\n\n    template\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// /var/www/shopware/custom/plugins/SwagProductDiscount/Resources/views/src/manifest.js\n// module id = 774\n// module chunks = 3","module.exports = \"{% block core_product_detail_workspace_additional %}\\n\\n    <sw-card title=\\\"Abschlag\\\">\\n\\n        <sw-field label=\\\"Discount\\\" suffix=\\\"%\\\" v-model.number=\\\"productDiscount\\\"></sw-field>\\n\\n    </sw-card>\\n\\n{% endblock %}\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// /var/www/shopware/custom/plugins/SwagProductDiscount/Resources/views/administration/product-detail.html\n// module id = 775\n// module chunks = 3","export default function SwagProductDiscountService(client) {\n    /**\n     * Defines the return format for the API. The API can provide the content as JSON (json) or XML (xml).\n     * @type {String} [returnFormat=json]\n     */\n    const returnFormat = 'json';\n    return {\n        readByProductDetailUuid,\n        update\n    };\n    function readByProductDetailUuid(productDetailUuid) {\n        const queryString = JSON.stringify({\n            type: 'nested',\n            queries: [\n                {\n                    type: 'term',\n                    field: 'product_detail_uuid',\n                    value: productDetailUuid\n                }\n            ]\n        });\n        const url = `swagProductDiscount.${returnFormat}?query=${queryString}`;\n        return client.get(url).then((response) => {\n            return response.data;\n        });\n    }\n    function update(payload) {\n        const url = `swagProductDiscount.${returnFormat}`;\n        return client.patch(url, payload).then((response) => {\n            return response.data;\n        });\n    }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /var/www/shopware/custom/plugins/SwagProductDiscount/Resources/views/src/swag_product_discount.service.js\n// module id = 776\n// module chunks = 3"],"sourceRoot":""}